E = source(line,"q.txt",",",type(<src:string,label:string,dest:string>));


G = select < src: s, label: e.label, dest: e.dest, count: c >
      from (s,c,es) in (select (k,count(e),e)
                          from e in E
                         group by k: e.src),
           e in es;


select ( sx, sy, count(x)/(cx+cy-count(x)) )
from x in G, y in G
where x.label=y.label and x.dest=y.dest and x.src < y.src
group by (sx,cx,sy,cy): (x.src,x.count,y.src,y.count);
