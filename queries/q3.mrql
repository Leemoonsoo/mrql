/* location of the TPCH benchmark data */
TPCH = "/home/fegaras/tpch/data2/";

C = source(line,TPCH+"customer.tbl","|",type(<CUSTKEY:int,NAME:string,ADDRESS:string>));
O = source(line,TPCH+"orders.tbl","|",type(<ORDERKEY:int,CUSTKEY:int,ORDERSTATUS:string,TOTALPRICE:float>));

select (key,count(p),avg(p))
from <CUSTKEY:k,TOTALPRICE:p> in O
group by key: k
order by inv(count(p));
